
name := "Robert'; drop table students;--"

def s:String => $SQL
    return bitcast "\x1b[0;35m'$(s.replace("'","\x1b[34;1m''\x1b[0;35m"))'\x1b[m" : $SQL

def i:Int => $SQL return bitcast "\x1b[0;35m$i\x1b[m" : $SQL
def n:Num => $SQL return bitcast "\x1b[0;35m$n\x1b[m" : $SQL

age := 10
s := $SQL"SELECT * FROM students WHERE name = $name AND age > $age"
say "$s"

def s:String => $Quoted
    return bitcast "\x1b[0;35m\"$(s.replace('\','\\').replace('"','\"'))\"\x1b[m" : $Quoted

str := "one two"
str2 := 'with "quotes" in it'
say "$($Quoted[my strings are $str and $str2])"

def s:String => $HTML
    s = s.replace("&", "\x1b[34;1m&amp;\x1b[0;35m")
         .replace("<", "\x1b[34;1m&lt;\x1b[0;35m")
         .replace(">", "\x1b[34;1m&gt;\x1b[0;35m")
         .replace('"', "\x1b[34;1m&quot;\x1b[0;35m")
         .replace("'", "\x1b[34;1m&#39;\x1b[0;35m")

    return bitcast "\x1b[0;35m$s\x1b[m" : $HTML

text := "I <3 escaping"
say "$($HTML[<pre>$text</pre>])"
